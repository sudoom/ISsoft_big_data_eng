{"paragraphs":[{"text":"%sh\n\n# if [[-d /tmp/ml-latest]]; then\n#     rm -fr /tmp/ml-latest\n#     echo \"Removed existing folder\"\n# fi\n\nwget -q -O /tmp/ml-latest.zip http://files.grouplens.org/datasets/movielens/ml-latest.zip\necho \"Dowloaded ml-latest.zip ...\"\n\nunzip /tmp/ml-latest.zip -d /tmp/\nrm /tmp/ml-latest.zip\necho \"Unpacked ml-latest.zip ...\"\n\ndir0=/tmp/datalake\ndir1=links\ndir2=movies\ndir3=ratings\ndir4=tags\ndir5=/user/zeppelin/sparkDF/input\n\nfor dir in $dir1 $dir2 $dir3 $dir4;do\n# if [[-d $dir0/$dir]]; then\n#     rm -r $dir0/$dir1\n# fi\n    mkdir -p $dir0/$dir\n    \n    mv /tmp/ml-latest/$dir.csv $dir0/$dir/\n    echo \"Moved $dir.csv to $dir0/$dir/ ...\"\ndone\n\nrm -r /tmp/ml-latest\necho \"Datalake files created!\"\n\nhdfs dfs -mkdir -p $dir5\necho \"Directory $dir5 created in hdfs\"\nhdfs dfs -put -f $dir0/$dir3/$dir3.csv $dir0/$dir2/$dir2.csv $dir5\necho \"Copy $dir3.csv to hdfs://$dir5 complete\"\necho \"Copy $dir2.csv to hdfs://$dir5 complete\"","user":"anonymous","dateUpdated":"2020-03-30T19:49:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Dowloaded ml-latest.zip ...\nArchive:  /tmp/ml-latest.zip\n   creating: /tmp/ml-latest/\n  inflating: /tmp/ml-latest/links.csv  \n  inflating: /tmp/ml-latest/tags.csv  \n  inflating: /tmp/ml-latest/genome-tags.csv  \n  inflating: /tmp/ml-latest/ratings.csv  \n  inflating: /tmp/ml-latest/README.txt  \n  inflating: /tmp/ml-latest/genome-scores.csv  \n  inflating: /tmp/ml-latest/movies.csv  \nUnpacked ml-latest.zip ...\nMoved links.csv to /tmp/datalake/links/ ...\nMoved movies.csv to /tmp/datalake/movies/ ...\nMoved ratings.csv to /tmp/datalake/ratings/ ...\nMoved tags.csv to /tmp/datalake/tags/ ...\nDatalake files created!\nDirectory /user/zeppelin/sparkDF/input created in hdfs\nCopy ratings.csv to hdfs:///user/zeppelin/sparkDF/input complete\nCopy movies.csv to hdfs:///user/zeppelin/sparkDF/input complete\n"}]},"apps":[],"jobName":"paragraph_1585400539503_-1754603216","id":"20200328-130219_1734486278","dateCreated":"2020-03-28T13:02:19+0000","dateStarted":"2020-03-30T19:49:29+0000","dateFinished":"2020-03-30T19:49:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9637"},{"text":"%spark.ipyspark\n\n# parametres\n\nN = 5\nmovies_file = \"hdfs:///user/zeppelin/sparkDF/input/movies.csv\"\nratings_file = \"hdfs:///user/zeppelin/sparkDF/input/ratings.csv\"\noutput_dir = \"hdfs:///user/zeppelin/sparkDF/output\"","user":"anonymous","dateUpdated":"2020-03-30T20:10:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585400578169_-1514174400","id":"20200328-130258_1938062273","dateCreated":"2020-03-28T13:02:58+0000","dateStarted":"2020-03-30T20:10:47+0000","dateFinished":"2020-03-30T20:10:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9638"},{"text":"%spark.ipyspark\n\n# support functions\n\n# from functools import reduce\nimport pyspark.sql.functions as func\n\n\ndef blank_as_null(x):\n    return func.when(func.col(x) != \"\", func.col(x)).otherwise(None)\n\n\n# def blank_multiply_columns(df, column_list):\n#     tmp = []\n#     for column in df.columns:\n#         if column in column_list:\n#             tmp.append(blank_as_null(column).alias(column))\n#         else:\n#             tmp.append(column)\n#     return tmp\n# columns_to_convert = joined_df.columns[1:3]\n\n# filtered_df = reduce(lambda df, x: df.withColumn(x, blank_as_null(x)), columns_to_convert, sorted_df).dropna()\n# filtered_df = joined_df.select(*blank_multiply_columns(sorted_df, columns_to_convert)).dropna()","user":"anonymous","dateUpdated":"2020-03-30T20:10:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585407253720_-66694430","id":"20200328-145413_1415079767","dateCreated":"2020-03-28T14:54:13+0000","dateStarted":"2020-03-30T20:10:49+0000","dateFinished":"2020-03-30T20:10:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9639"},{"text":"%spark.ipyspark\n\nmovies_df = spark.read.format(\"csv\").options(header=\"true\").load(movies_file)\nratings_df = spark.read.format(\"csv\").options(header=\"true\").load(ratings_file)","user":"anonymous","dateUpdated":"2020-03-30T20:10:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=99","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=100"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585400885369_964513582","id":"20200328-130805_2029052764","dateCreated":"2020-03-28T13:08:05+0000","dateStarted":"2020-03-30T20:10:56+0000","dateFinished":"2020-03-30T20:10:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9640"},{"text":"%spark.ipyspark\n\nmovies_df.show(5)\n# movies_df.count()","user":"anonymous","dateUpdated":"2020-03-30T20:17:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+--------------------+\n|movieId|               title|              genres|\n+-------+--------------------+--------------------+\n|      1|    Toy Story (1995)|Adventure|Animati...|\n|      2|      Jumanji (1995)|Adventure|Childre...|\n|      3|Grumpier Old Men ...|      Comedy|Romance|\n|      4|Waiting to Exhale...|Comedy|Drama|Romance|\n|      5|Father of the Bri...|              Comedy|\n+-------+--------------------+--------------------+\nonly showing top 5 rows\n\n58098"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=101","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=102"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585401384238_-714062380","id":"20200328-131624_1318971908","dateCreated":"2020-03-28T13:16:24+0000","dateStarted":"2020-03-30T20:11:00+0000","dateFinished":"2020-03-30T20:11:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9641"},{"text":"%spark.ipyspark\n\nratings_df.show(5)\n# ratings_df.count()","user":"anonymous","dateUpdated":"2020-03-30T20:17:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+------+----------+\n|userId|movieId|rating| timestamp|\n+------+-------+------+----------+\n|     1|    307|   3.5|1256677221|\n|     1|    481|   3.5|1256677456|\n|     1|   1091|   1.5|1256677471|\n|     1|   1257|   4.5|1256677460|\n|     1|   1449|   4.5|1256677264|\n+------+-------+------+----------+\nonly showing top 5 rows\n\n27753444"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=103","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=104"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585401386173_2019861790","id":"20200328-131626_856338591","dateCreated":"2020-03-28T13:16:26+0000","dateStarted":"2020-03-30T20:11:06+0000","dateFinished":"2020-03-30T20:11:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9642"},{"text":"%spark.ipyspark\n\nmovies_normalized_df = movies_df.select(movies_df.movieId,\n                                        func.regexp_extract(movies_df.title, '(.+)[ ]+[(](\\\\d{4})[)]', 1).alias('title'),\n                                        func.regexp_extract(movies_df.title, '(.+)[ ]+[(](\\\\d{4})[)]', 2).alias('year'),\n                                        func.explode(func.split(movies_df.genres, '\\\\|')).alias('genre')) \\\n                                .withColumn(\"title\", blank_as_null(\"title\")) \\\n                                .withColumn(\"year\", blank_as_null(\"year\")) \\\n                                .dropna()\n    \n","user":"anonymous","dateUpdated":"2020-03-30T20:11:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585402583519_1337064869","id":"20200328-133623_2135719765","dateCreated":"2020-03-28T13:36:23+0000","dateStarted":"2020-03-30T20:11:29+0000","dateFinished":"2020-03-30T20:11:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9643"},{"text":"%spark.ipyspark\n\nmovies_normalized_df.show(5)\n# movies_normalized_df.count()","user":"anonymous","dateUpdated":"2020-03-30T20:17:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------+----+---------+\n|movieId|    title|year|    genre|\n+-------+---------+----+---------+\n|      1|Toy Story|1995|Adventure|\n|      1|Toy Story|1995|Animation|\n|      1|Toy Story|1995| Children|\n|      1|Toy Story|1995|   Comedy|\n|      1|Toy Story|1995|  Fantasy|\n+-------+---------+----+---------+\nonly showing top 5 rows\n\n105695"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=105","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=106"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585402949567_160504051","id":"20200328-134229_322906427","dateCreated":"2020-03-28T13:42:29+0000","dateStarted":"2020-03-30T20:11:33+0000","dateFinished":"2020-03-30T20:11:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9644"},{"text":"%spark.ipyspark\n\nratings_normalized_df = ratings_df.groupBy(\"movieId\") \\\n                                  .agg({\"rating\": \"mean\"}) \\\n                                  .withColumnRenamed(\"avg(rating)\", \"avg_rating\")\nratings_normalized_df = ratings_normalized_df.withColumn(\"avg_rating\", func.round(ratings_normalized_df.avg_rating, 2))","user":"anonymous","dateUpdated":"2020-03-30T20:11:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585402974987_1367541008","id":"20200328-134254_1528256088","dateCreated":"2020-03-28T13:42:54+0000","dateStarted":"2020-03-30T20:11:40+0000","dateFinished":"2020-03-30T20:11:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9645"},{"text":"%spark.ipyspark\n\nratings_normalized_df.show(5)\n# ratings_normalized_df.count()","user":"anonymous","dateUpdated":"2020-03-30T20:17:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+\n|movieId|avg_rating|\n+-------+----------+\n|    296|      4.17|\n|   1090|       3.9|\n|   2294|      3.24|\n|   3210|      3.64|\n|  48738|      3.85|\n+-------+----------+\nonly showing top 5 rows\n\n53889"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=107","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=108"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585403333894_1064425421","id":"20200328-134853_1931470074","dateCreated":"2020-03-28T13:48:53+0000","dateStarted":"2020-03-30T20:11:43+0000","dateFinished":"2020-03-30T20:13:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9646"},{"text":"%spark.ipyspark\n\njoined_df = movies_normalized_df.join(ratings_normalized_df, \"movieId\", \"inner\") \\\n                                .select(\"genre\", \"title\", \"year\", \"avg_rating\")","user":"anonymous","dateUpdated":"2020-03-30T20:13:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585403575736_1902203283","id":"20200328-135255_1994251637","dateCreated":"2020-03-28T13:52:55+0000","dateStarted":"2020-03-30T20:13:27+0000","dateFinished":"2020-03-30T20:13:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9647"},{"text":"%spark.ipyspark\n\njoined_df.show(5)\n# joined_df.count()","user":"anonymous","dateUpdated":"2020-03-30T20:17:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------------+----+----------+\n|   genre|       title|year|avg_rating|\n+--------+------------+----+----------+\n|Thriller|Pulp Fiction|1994|      4.17|\n|   Drama|Pulp Fiction|1994|      4.17|\n|   Crime|Pulp Fiction|1994|      4.17|\n|  Comedy|Pulp Fiction|1994|      4.17|\n|     War|     Platoon|1986|       3.9|\n+--------+------------+----+----------+\nonly showing top 5 rows\n\n98884"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=109","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=110","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=111","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=112"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585404640614_1220115052","id":"20200328-141040_536444928","dateCreated":"2020-03-28T14:10:40+0000","dateStarted":"2020-03-30T20:13:29+0000","dateFinished":"2020-03-30T20:15:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9648"},{"text":"%spark.ipyspark\n\nfrom pyspark.sql.window import Window\n\nwindow  = Window.partitionBy(joined_df.genre).orderBy(joined_df.avg_rating.desc())\ncsv_df = joined_df.withColumn(\"rank\", func.row_number().over(window))\ncsv_df = csv_df.filter(csv_df.rank <= N) \\\n               .sort(\"genre\", \"avg_rating\", ascending=[1,0]) \\\n               .drop(\"rank\")","user":"anonymous","dateUpdated":"2020-03-30T20:15:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585591266945_1462935411","id":"20200330-180106_1750996756","dateCreated":"2020-03-30T18:01:06+0000","dateStarted":"2020-03-30T20:15:40+0000","dateFinished":"2020-03-30T20:15:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9649"},{"text":"%spark.ipyspark\n\ncsv_df.show(10)\n# csv_df.count()","user":"anonymous","dateUpdated":"2020-03-30T20:18:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------------+----+----------+\n|             genre|               title|year|avg_rating|\n+------------------+--------------------+----+----------+\n|(no genres listed)|          Mary & Tim|1996|       5.0|\n|(no genres listed)|        Aschenputtel|1989|       5.0|\n|(no genres listed)|Sondheim! The Bir...|2010|       5.0|\n|(no genres listed)|Ram Dass: Fierce ...|2001|       5.0|\n|(no genres listed)|    The Pilot's Wife|2005|       5.0|\n|            Action|              Khushi|2001|       5.0|\n|            Action|A Police Inspecto...|1974|       5.0|\n|            Action|  Day of the Panther|1988|       5.0|\n|            Action|     The Last Bullet|1973|       5.0|\n|            Action|        Pony Express|1953|       5.0|\n+------------------+--------------------+----+----------+\nonly showing top 10 rows\n\n100"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=113","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=114","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=115","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=116","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=117"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585592915844_777666084","id":"20200330-182835_645217550","dateCreated":"2020-03-30T18:28:35+0000","dateStarted":"2020-03-30T20:15:44+0000","dateFinished":"2020-03-30T20:17:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9650"},{"text":"%spark.ipyspark\n\ncsv_df.repartition(1).write.csv(path=output_dir,\n             mode=\"overwrite\", \n             sep=\",\", \n             header=True)\n    # .format('csv') \\\n    # .option('header', 'true') \\\n    # .option('delimiter', ',') \\\n    # .option('encoding', 'utf-8') \\\n    # .option('path', output_dir) \\\n    # .save(\"test\")\n    # .saveAsTable('movies_mapped_and_filtered')","user":"anonymous","dateUpdated":"2020-03-30T20:20:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=121","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=122","http://cluster-37ab-m.us-central1-b.c.issoft-271914.internal:4042/jobs/job?id=123"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585409271139_-29173005","id":"20200328-152751_1483401875","dateCreated":"2020-03-28T15:27:51+0000","dateStarted":"2020-03-30T20:20:03+0000","dateFinished":"2020-03-30T20:21:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9651"},{"text":"%sh\n\n# hdfs dfs -rm -r /user/zeppelin/sparkDF/output","user":"anonymous","dateUpdated":"2020-03-30T20:19:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/zeppelin/sparkDF/output\n"}]},"apps":[],"jobName":"paragraph_1585416955000_888019723","id":"20200328-173555_810828509","dateCreated":"2020-03-28T17:35:55+0000","dateStarted":"2020-03-30T20:19:49+0000","dateFinished":"2020-03-30T20:19:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9652"},{"text":"%sh\n\nhdfs dfs -cat /user/zeppelin/sparkDF/output/*0.csv","user":"anonymous","dateUpdated":"2020-03-30T20:21:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"genre,title,year,avg_rating\n(no genres listed),The Pilot's Wife,2005,5.0\n(no genres listed),Sondheim! The Birthday Concert,2010,5.0\n(no genres listed),Aschenputtel,1989,5.0\n(no genres listed),Mary & Tim,1996,5.0\n(no genres listed),Ram Dass: Fierce Grace,2001,5.0\nAction,Day of the Panther,1988,5.0\nAction,The Last Bullet,1973,5.0\nAction,Khushi,2001,5.0\nAction,A Police Inspector Calls,1974,5.0\nAction,Pony Express,1953,5.0\nAdventure,Windstorm 2,2015,5.0\nAdventure,I Spy Returns,1994,5.0\nAdventure,War Arrow,1954,5.0\nAdventure,Goliath and the Sins of Babylon,1963,5.0\nAdventure,\"Captain Blood (Le capitan) (Invincible Swordsman, The)\",1960,5.0\nAnimation,The Story of Anyburg U.S.A.,1957,5.0\nAnimation,Free Jimmy,2006,5.0\nAnimation,Lotte and the Moonstone Secret,2011,5.0\nAnimation,Step Up Love Story (Futari ecchi),2002,4.75\nAnimation,The Little Engine That Could,2011,4.5\nChildren,Tony 10,2012,5.0\nChildren,The King and Queen of Moonlight Bay,2003,5.0\nChildren,Snow White,1987,5.0\nChildren,Windstorm 2,2015,5.0\nChildren,Bound & Babysitting,2015,5.0\nComedy,Living on Love,1937,5.0\nComedy,Brad Williams: Daddy Issues,2016,5.0\nComedy,Humpty Sharma Ki Dulhania,2014,5.0\nComedy,Inquire Within,2012,5.0\nComedy,The Biggest Fan,2002,5.0\nCrime,Night Key,1937,5.0\nCrime,The Swindlers,2017,5.0\nCrime,The Last Bullet,1973,5.0\nCrime,A Police Inspector Calls,1974,5.0\nCrime,Revenge,1978,5.0\nDocumentary,Father of Lights,2012,5.0\nDocumentary,People of a Feather,2012,5.0\nDocumentary,Matrix of Evil,2003,5.0\nDocumentary,Welcome to Australia,1999,5.0\nDocumentary,Beatles Stories,2011,5.0\nDrama,Mandy,1952,5.0\nDrama,Humpty Sharma Ki Dulhania,2014,5.0\nDrama,Kryptonite!,2011,5.0\nDrama,Peacock,2015,5.0\nDrama,Queen of Carthage,2013,5.0\nFantasy,Rocaterrania,2009,5.0\nFantasy,Assepoester: Een Modern Sprookje,2014,5.0\nFantasy,Edge of the Garden,2011,5.0\nFantasy,Fatty Finn,1980,5.0\nFantasy,The Lost Letter,1972,5.0\nFilm-Noir,\"Third Man, The\",1949,4.2\nFilm-Noir,Double Indemnity,1944,4.2\nFilm-Noir,Sunset Blvd. (a.k.a. Sunset Boulevard),1950,4.2\nFilm-Noir,M,1931,4.16\nFilm-Noir,Notorious,1946,4.16\nHorror,Despite the Night,2015,5.0\nHorror,Horror Stories 2,2013,5.0\nHorror,Wolfguy - Enraged Lycanthrope,1975,5.0\nHorror,Siccîn,2014,5.0\nHorror,Ab-normal Beauty,2004,5.0\nIMAX,\"Dark Knight, The\",2008,4.17\nIMAX,Inception,2010,4.16\nIMAX,Interstellar,2014,4.09\nIMAX,\"Dark Knight Rises, The\",2012,3.98\nIMAX,Edge of Tomorrow,2014,3.94\nMusical,Comin' Round the Mountain,1951,5.0\nMusical,Latin Music USA,2009,5.0\nMusical,Listen Darling,1938,4.75\nMusical,Let the Good Times Roll,1973,4.5\nMusical,\"2013 Rock and Roll Hall of Fame Induction Ceremony, The\",2013,4.5\nMystery,Poison,2000,5.0\nMystery,Roxy Hunter and the Secret of the Shaman,2008,5.0\nMystery,A Sister's Secret,2009,5.0\nMystery,The Good Mother,2013,5.0\nMystery,Say Nothing,2001,5.0\nRomance,Living on Love,1937,5.0\nRomance,Humpty Sharma Ki Dulhania,2014,5.0\nRomance,The Biggest Fan,2002,5.0\nRomance,Peacock,2015,5.0\nRomance,And Love Has Vanished,1961,5.0\nSci-Fi,Night Key,1937,5.0\nSci-Fi,Say Nothing,2001,5.0\nSci-Fi,Awaken,2013,5.0\nSci-Fi,The Hexer,2001,5.0\nSci-Fi,Pale,2016,5.0\nThriller,Queen of Carthage,2013,5.0\nThriller,The Last Bullet,1973,5.0\nThriller,\"Love, Cheat & Steal\",1993,5.0\nThriller,The Hunt for the Unicorn Killer,1999,5.0\nThriller,Twisted Seduction,2010,5.0\nWar,\"In the Meantime, Darling\",1944,5.0\nWar,The Last Hunter,1980,5.0\nWar,Until They Sail,1957,5.0\nWar,The Undefeated,2000,5.0\nWar,War Arrow,1954,5.0\nWestern,Lonesome Dove Church,2014,5.0\nWestern,Pony Express,1953,5.0\nWestern,War Arrow,1954,5.0\nWestern,The Last Hunt,1956,5.0\nWestern,Rio Diablo,1993,5.0\n"}]},"apps":[],"jobName":"paragraph_1585417174821_-278579911","id":"20200328-173934_821873549","dateCreated":"2020-03-28T17:39:34+0000","dateStarted":"2020-03-30T20:21:16+0000","dateFinished":"2020-03-30T20:21:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9653"},{"text":"%sh\n\nhdfs dfs -ls /user/zeppelin/sparkDF/output","user":"anonymous","dateUpdated":"2020-03-30T20:21:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 2 items\n-rw-r--r--   2 zeppelin hadoop          0 2020-03-30 20:21 /user/zeppelin/sparkDF/output/_SUCCESS\n-rw-r--r--   2 zeppelin hadoop       3603 2020-03-30 20:21 /user/zeppelin/sparkDF/output/part-00000-d96932d9-c479-4fc2-857b-9ebd4f366d91-c000.csv\n"}]},"apps":[],"jobName":"paragraph_1585430109253_-320722602","id":"20200328-211509_1872645727","dateCreated":"2020-03-28T21:15:09+0000","dateStarted":"2020-03-30T20:21:08+0000","dateFinished":"2020-03-30T20:21:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9654"}],"name":"Issoft/pyspark-topN-movies(Dataframe)","id":"2F43XB892","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}