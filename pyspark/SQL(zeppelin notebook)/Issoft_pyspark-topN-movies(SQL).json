{"paragraphs":[{"text":"%sh\n\n# if [[-d /tmp/ml-latest]]; then\n#     rm -fr /tmp/ml-latest\n#     echo \"Removed existing folder\"\n# fi\n\nwget -q -O /tmp/ml-latest.zip http://files.grouplens.org/datasets/movielens/ml-latest.zip\necho \"Dowloaded ml-latest.zip ...\"\n\nunzip /tmp/ml-latest.zip -d /tmp/\nrm /tmp/ml-latest.zip\necho \"Unpacked ml-latest.zip ...\"\n\ndir0=/tmp/datalake\ndir1=links\ndir2=movies\ndir3=ratings\ndir4=tags\ndir5=/user/zeppelin/sparkSQL/input\n\nfor dir in $dir1 $dir2 $dir3 $dir4;do\n# if [[-d $dir0/$dir]]; then\n#     rm -r $dir0/$dir1\n# fi\n    mkdir -p $dir0/$dir\n    \n    mv /tmp/ml-latest/$dir.csv $dir0/$dir/\n    echo \"Moved $dir.csv to $dir0/$dir/ ...\"\ndone\n\nrm -r /tmp/ml-latest\necho \"Datalake files created!\"\n\nhdfs dfs -mkdir -p $dir5\necho \"Directory $dir5 created in hdfs\"\nhdfs dfs -put -f $dir0/$dir3/$dir3.csv $dir0/$dir2/$dir2.csv $dir5\necho \"Copy $dir3.csv to hdfs://$dir5 complete\"\necho \"Copy $dir2.csv to hdfs://$dir5 complete\"","user":"anonymous","dateUpdated":"2020-04-01T01:26:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Dowloaded ml-latest.zip ...\nArchive:  /tmp/ml-latest.zip\n   creating: /tmp/ml-latest/\n  inflating: /tmp/ml-latest/links.csv  \n  inflating: /tmp/ml-latest/tags.csv  \n  inflating: /tmp/ml-latest/genome-tags.csv  \n  inflating: /tmp/ml-latest/ratings.csv  \n  inflating: /tmp/ml-latest/README.txt  \n  inflating: /tmp/ml-latest/genome-scores.csv  \n  inflating: /tmp/ml-latest/movies.csv  \nUnpacked ml-latest.zip ...\nMoved links.csv to /tmp/datalake/links/ ...\nMoved movies.csv to /tmp/datalake/movies/ ...\nMoved ratings.csv to /tmp/datalake/ratings/ ...\nMoved tags.csv to /tmp/datalake/tags/ ...\nDatalake files created!\nDirectory /user/zeppelin/sparkSQL/input created in hdfs\nCopy ratings.csv to hdfs:///user/zeppelin/sparkSQL/input complete\nCopy movies.csv to hdfs:///user/zeppelin/sparkSQL/input complete\n"}]},"apps":[],"jobName":"paragraph_1585673000976_-1527733237","id":"20200331-164320_744840500","dateCreated":"2020-03-31T16:43:20+0000","dateStarted":"2020-04-01T01:26:26+0000","dateFinished":"2020-04-01T01:26:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:398"},{"text":"%spark.ipyspark\n\n# parametres\n\nN = 5\nmovies_file = \"hdfs:///user/zeppelin/sparkSQL/input/movies.csv\"\nratings_file = \"hdfs:///user/zeppelin/sparkSQL/input/ratings.csv\"\noutput_dir = \"hdfs:///user/zeppelin/sparkSQL/output\"","user":"anonymous","dateUpdated":"2020-04-01T01:27:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585673031519_-1356826905","id":"20200331-164351_1149227292","dateCreated":"2020-03-31T16:43:51+0000","dateStarted":"2020-04-01T01:27:00+0000","dateFinished":"2020-04-01T01:27:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:399"},{"text":"%spark.ipyspark\n\nmovies_df = spark.read.format(\"csv\").options(header=\"true\").load(movies_file)\nratings_df = spark.read.format(\"csv\").options(header=\"true\").load(ratings_file)\n\nmovies_df.createOrReplaceTempView(\"movies\")\nratings_df.createOrReplaceTempView(\"ratings\")","user":"anonymous","dateUpdated":"2020-04-01T01:27:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585673130487_1164885267","id":"20200331-164530_394500940","dateCreated":"2020-03-31T16:45:30+0000","dateStarted":"2020-04-01T01:27:01+0000","dateFinished":"2020-04-01T01:27:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"text":"%sql\n\nselect * from movies limit 10 \n","user":"anonymous","dateUpdated":"2020-04-01T01:27:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","title":"string","genres":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"movieId","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"title","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\ttitle\tgenres\n1\tToy Story (1995)\tAdventure|Animation|Children|Comedy|Fantasy\n2\tJumanji (1995)\tAdventure|Children|Fantasy\n3\tGrumpier Old Men (1995)\tComedy|Romance\n4\tWaiting to Exhale (1995)\tComedy|Drama|Romance\n5\tFather of the Bride Part II (1995)\tComedy\n6\tHeat (1995)\tAction|Crime|Thriller\n7\tSabrina (1995)\tComedy|Romance\n8\tTom and Huck (1995)\tAdventure|Children\n9\tSudden Death (1995)\tAction\n10\tGoldenEye (1995)\tAction|Adventure|Thriller\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585673481639_-246844721","id":"20200331-165121_1117202403","dateCreated":"2020-03-31T16:51:21+0000","dateStarted":"2020-04-01T01:27:04+0000","dateFinished":"2020-04-01T01:27:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"text":"%sql\n\nselect * from ratings limit 10","user":"anonymous","dateUpdated":"2020-04-01T01:27:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"userId":"string","movieId":"string","rating":"string","timestamp":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"userId\tmovieId\trating\ttimestamp\n1\t307\t3.5\t1256677221\n1\t481\t3.5\t1256677456\n1\t1091\t1.5\t1256677471\n1\t1257\t4.5\t1256677460\n1\t1449\t4.5\t1256677264\n1\t1590\t2.5\t1256677236\n1\t1591\t1.5\t1256677475\n1\t2134\t4.5\t1256677464\n1\t2478\t4.0\t1256677239\n1\t2840\t3.0\t1256677500\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585673604844_311577595","id":"20200331-165324_648680830","dateCreated":"2020-03-31T16:53:24+0000","dateStarted":"2020-04-01T01:27:04+0000","dateFinished":"2020-04-01T01:27:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:402"},{"text":"%pyspark\n\nratings_normalized_df = spark.sql(\"\"\"\nSELECT movieId, \nround(avg(rating), 2) AS avg_rating\nFROM ratings \nGROUP BY movieId\n-- LIMIT 10\n    \"\"\")\nratings_normalized_df.createOrReplaceTempView(\"ratings_normalized_df\")\n\n","user":"anonymous","dateUpdated":"2020-04-01T01:27:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585682067204_-1237416240","id":"20200331-191427_1817721265","dateCreated":"2020-03-31T19:14:27+0000","dateStarted":"2020-04-01T01:27:05+0000","dateFinished":"2020-04-01T01:27:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"text":"%pyspark\nratings_normalized_df.show(10)","user":"anonymous","dateUpdated":"2020-04-01T01:27:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+\n|movieId|avg_rating|\n+-------+----------+\n|    296|      4.17|\n|   1090|       3.9|\n|   2294|      3.24|\n|   3210|      3.64|\n|  48738|      3.85|\n|    691|      3.05|\n| 115713|      3.96|\n|   5325|      3.73|\n|   4821|      3.19|\n|   2136|      2.82|\n+-------+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585684804618_-62987731","id":"20200331-200004_470291105","dateCreated":"2020-03-31T20:00:04+0000","dateStarted":"2020-04-01T01:27:06+0000","dateFinished":"2020-04-01T01:27:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:404"},{"text":"%sql\nSELECT movieId, \nround(avg(rating), 2) AS avg_rating\nFROM ratings \nGROUP BY movieId\nLIMIT 10\n\n","user":"anonymous","dateUpdated":"2020-04-01T01:28:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","avg_rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\tavg_rating\n2294\t3.24\n1090\t3.9\n296\t4.17\n3959\t3.68\n2136\t2.82\n3210\t3.64\n5325\t3.73\n2162\t2.49\n48738\t3.85\n88140\t3.52\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585679537960_-1610573099","id":"20200331-183217_1110029966","dateCreated":"2020-03-31T18:32:17+0000","dateStarted":"2020-04-01T01:27:42+0000","dateFinished":"2020-04-01T01:28:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:405"},{"text":"%pyspark\nmovies_normalized_df = spark.sql(\"\"\"\nSELECT movieId,\nREGEXP_EXTRACT(title, \"(.+)[ ]+\\\\\\((\\\\\\d{4})\\\\\\)\", 1) AS title,\nREGEXP_EXTRACT(title, '(.+)[ ]+\\\\\\((\\\\\\d{4})\\\\\\)', 2) AS year,\nEXPLODE(SPLIT(genres, \"\\\\\\|\")) AS genre\nFROM movies\n-- LIMIT 10\n\"\"\")\nmovies_normalized_df.createOrReplaceTempView(\"movies_normalized_df\")","user":"anonymous","dateUpdated":"2020-04-01T01:28:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585682402806_-1464250867","id":"20200331-192002_1494956467","dateCreated":"2020-03-31T19:20:02+0000","dateStarted":"2020-04-01T01:28:11+0000","dateFinished":"2020-04-01T01:28:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:406"},{"text":"%pyspark\nmovies_normalized_df.show(10)","user":"anonymous","dateUpdated":"2020-04-01T01:28:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------------+----+---------+\n|movieId|           title|year|    genre|\n+-------+----------------+----+---------+\n|      1|       Toy Story|1995|Adventure|\n|      1|       Toy Story|1995|Animation|\n|      1|       Toy Story|1995| Children|\n|      1|       Toy Story|1995|   Comedy|\n|      1|       Toy Story|1995|  Fantasy|\n|      2|         Jumanji|1995|Adventure|\n|      2|         Jumanji|1995| Children|\n|      2|         Jumanji|1995|  Fantasy|\n|      3|Grumpier Old Men|1995|   Comedy|\n|      3|Grumpier Old Men|1995|  Romance|\n+-------+----------------+----+---------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585704112225_-1163587911","id":"20200401-012152_798405325","dateCreated":"2020-04-01T01:21:52+0000","dateStarted":"2020-04-01T01:28:12+0000","dateFinished":"2020-04-01T01:28:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:407"},{"text":"%sql\nSELECT movieId,\nREGEXP_EXTRACT(title, \"(.+)[ ]+\\\\\\((\\\\\\d{4})\\\\\\)\", 1) AS title,\nREGEXP_EXTRACT(title, '(.+)[ ]+\\\\\\((\\\\\\d{4})\\\\\\)', 2) AS year,\nEXPLODE(SPLIT(genres, \"\\\\\\|\")) AS genre\nFROM movies\nLIMIT 10","user":"anonymous","dateUpdated":"2020-04-01T01:28:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","title":"string","year":"string","genre":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\ttitle\tyear\tgenre\n1\tToy Story\t1995\tAdventure\n1\tToy Story\t1995\tAnimation\n1\tToy Story\t1995\tChildren\n1\tToy Story\t1995\tComedy\n1\tToy Story\t1995\tFantasy\n2\tJumanji\t1995\tAdventure\n2\tJumanji\t1995\tChildren\n2\tJumanji\t1995\tFantasy\n3\tGrumpier Old Men\t1995\tComedy\n3\tGrumpier Old Men\t1995\tRomance\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585688117668_-1926210529","id":"20200331-205517_795205250","dateCreated":"2020-03-31T20:55:17+0000","dateStarted":"2020-04-01T01:28:13+0000","dateFinished":"2020-04-01T01:28:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:408"},{"text":"%pyspark\nmovies_nullable_title_year = spark.sql(\"\"\"\nSELECT movieId,\ngenre,\nCASE\n    WHEN ( title != \"\") THEN title\n    ELSE NULL\nEND as title,\nCASE\n    WHEN ( year != \"\") THEN year\n    ELSE NULL\nEND as year\nFROM movies_normalized_df\n-- LIMIT 10\n\"\"\")\n\nmovies_nullable_title_year.createOrReplaceTempView(\"movies_nullable_title_year\")","user":"anonymous","dateUpdated":"2020-04-01T01:30:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585702429978_1758857737","id":"20200401-005349_353547825","dateCreated":"2020-04-01T00:53:49+0000","dateStarted":"2020-04-01T01:30:51+0000","dateFinished":"2020-04-01T01:30:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:409"},{"text":"%pyspark\nmovies_nullable_title_year.show(10)","user":"anonymous","dateUpdated":"2020-04-01T01:31:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------+----------------+----+\n|movieId|    genre|           title|year|\n+-------+---------+----------------+----+\n|      1|Adventure|       Toy Story|1995|\n|      1|Animation|       Toy Story|1995|\n|      1| Children|       Toy Story|1995|\n|      1|   Comedy|       Toy Story|1995|\n|      1|  Fantasy|       Toy Story|1995|\n|      2|Adventure|         Jumanji|1995|\n|      2| Children|         Jumanji|1995|\n|      2|  Fantasy|         Jumanji|1995|\n|      3|   Comedy|Grumpier Old Men|1995|\n|      3|  Romance|Grumpier Old Men|1995|\n+-------+---------+----------------+----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585703995673_-490462639","id":"20200401-011955_1499579742","dateCreated":"2020-04-01T01:19:55+0000","dateStarted":"2020-04-01T01:31:11+0000","dateFinished":"2020-04-01T01:31:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:410"},{"text":"%sql\nSELECT movieId,\ngenre,\nCASE\n    WHEN ( title != \"\") THEN title\n    ELSE NULL\nEND as title,\nCASE\n    WHEN ( year != \"\") THEN year\n    ELSE NULL\nEND as year\nFROM movies_normalized_df\nLIMIT 10\n","user":"anonymous","dateUpdated":"2020-04-01T01:31:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","genre":"string","title":"string","year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\tgenre\ttitle\tyear\n1\tAdventure\tToy Story\t1995\n1\tAnimation\tToy Story\t1995\n1\tChildren\tToy Story\t1995\n1\tComedy\tToy Story\t1995\n1\tFantasy\tToy Story\t1995\n2\tAdventure\tJumanji\t1995\n2\tChildren\tJumanji\t1995\n2\tFantasy\tJumanji\t1995\n3\tComedy\tGrumpier Old Men\t1995\n3\tRomance\tGrumpier Old Men\t1995\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585701337835_1834211864","id":"20200401-003537_1825540249","dateCreated":"2020-04-01T00:35:37+0000","dateStarted":"2020-04-01T01:31:26+0000","dateFinished":"2020-04-01T01:31:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:411"},{"text":"%pyspark\nmovies_blanked_df = spark.sql(\"\"\"\nSELECT *\nFROM movies_nullable_title_year\nWHERE title IS NOT NULL OR year IS NOT NULL\n-- LIMIT 10\n\"\"\")\nmovies_blanked_df.createOrReplaceTempView(\"movies_blanked_df\")","user":"anonymous","dateUpdated":"2020-04-01T01:34:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585703312197_-1254354597","id":"20200401-010832_510847243","dateCreated":"2020-04-01T01:08:32+0000","dateStarted":"2020-04-01T01:34:55+0000","dateFinished":"2020-04-01T01:34:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:412"},{"text":"%pyspark\nmovies_blanked_df.show(10)","user":"anonymous","dateUpdated":"2020-04-01T01:31:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------+----------------+----+\n|movieId|    genre|           title|year|\n+-------+---------+----------------+----+\n|      1|Adventure|       Toy Story|1995|\n|      1|Animation|       Toy Story|1995|\n|      1| Children|       Toy Story|1995|\n|      1|   Comedy|       Toy Story|1995|\n|      1|  Fantasy|       Toy Story|1995|\n|      2|Adventure|         Jumanji|1995|\n|      2| Children|         Jumanji|1995|\n|      2|  Fantasy|         Jumanji|1995|\n|      3|   Comedy|Grumpier Old Men|1995|\n|      3|  Romance|Grumpier Old Men|1995|\n+-------+---------+----------------+----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585703316981_1133643771","id":"20200401-010836_807713123","dateCreated":"2020-04-01T01:08:36+0000","dateStarted":"2020-04-01T01:31:49+0000","dateFinished":"2020-04-01T01:31:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:413"},{"text":"%sql\n\nSELECT *\nFROM movies_nullable_title_year\nWHERE title IS NOT NULL OR year IS NOT NULL\nLIMIT 10\n\n","user":"anonymous","dateUpdated":"2020-04-01T01:32:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","genre":"string","title":"string","year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\tgenre\ttitle\tyear\n1\tAdventure\tToy Story\t1995\n1\tAnimation\tToy Story\t1995\n1\tChildren\tToy Story\t1995\n1\tComedy\tToy Story\t1995\n1\tFantasy\tToy Story\t1995\n2\tAdventure\tJumanji\t1995\n2\tChildren\tJumanji\t1995\n2\tFantasy\tJumanji\t1995\n3\tComedy\tGrumpier Old Men\t1995\n3\tRomance\tGrumpier Old Men\t1995\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585703009113_-1900985023","id":"20200401-010329_5507136","dateCreated":"2020-04-01T01:03:29+0000","dateStarted":"2020-04-01T01:31:59+0000","dateFinished":"2020-04-01T01:31:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:414"},{"text":"%pyspark\njoined_df = spark.sql(\"\"\"\nSELECT genre,\ntitle,\nyear,\navg_rating\nFROM movies_blanked_df\nJOIN ratings_normalized_df\nON movies_blanked_df.movieId=ratings_normalized_df.movieId\n-- LIMIT 10\n\"\"\")\njoined_df.createOrReplaceTempView(\"joined_df\")","user":"anonymous","dateUpdated":"2020-04-01T01:35:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585682041581_-950586087","id":"20200331-191401_1489526142","dateCreated":"2020-03-31T19:14:01+0000","dateStarted":"2020-04-01T01:35:04+0000","dateFinished":"2020-04-01T01:35:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:415"},{"text":"%pyspark\njoined_df.show(10)","user":"anonymous","dateUpdated":"2020-04-01T01:37:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+------------+----+----------+\n|    genre|       title|year|avg_rating|\n+---------+------------+----+----------+\n|  Fantasy|        Antz|1998|      3.24|\n|   Comedy|        Antz|1998|      3.24|\n| Children|        Antz|1998|      3.24|\n|Animation|        Antz|1998|      3.24|\n|Adventure|        Antz|1998|      3.24|\n| Thriller|Pulp Fiction|1994|      4.17|\n|    Drama|Pulp Fiction|1994|      4.17|\n|    Crime|Pulp Fiction|1994|      4.17|\n|   Comedy|Pulp Fiction|1994|      4.17|\n|      War|     Platoon|1986|       3.9|\n+---------+------------+----+----------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585685602122_638775617","id":"20200331-201322_1506010011","dateCreated":"2020-03-31T20:13:22+0000","dateStarted":"2020-04-01T01:35:08+0000","dateFinished":"2020-04-01T01:35:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:416"},{"text":"%sql\nSELECT genre,\ntitle,\nyear,\navg_rating\nFROM movies_blanked_df\nJOIN ratings_normalized_df\nON movies_blanked_df.movieId=ratings_normalized_df.movieId\nLIMIT 10\n","user":"anonymous","dateUpdated":"2020-04-01T01:41:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"genre":"string","title":"string","year":"string","avg_rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttitle\tyear\tavg_rating\nFantasy\tAntz\t1998\t3.24\nComedy\tAntz\t1998\t3.24\nChildren\tAntz\t1998\t3.24\nAnimation\tAntz\t1998\t3.24\nAdventure\tAntz\t1998\t3.24\nThriller\tPulp Fiction\t1994\t4.17\nDrama\tPulp Fiction\t1994\t4.17\nCrime\tPulp Fiction\t1994\t4.17\nComedy\tPulp Fiction\t1994\t4.17\nWar\tPlatoon\t1986\t3.9\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585685766514_1798882034","id":"20200331-201606_1869905854","dateCreated":"2020-03-31T20:16:06+0000","dateStarted":"2020-04-01T01:37:56+0000","dateFinished":"2020-04-01T01:38:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:417"},{"text":"%pyspark\ncsv_df = spark.sql(\"\"\"\nSELECT *,\nROW_NUMBER() OVER (PARTITION BY genre ORDER BY avg_rating DESC) AS  rank\nFROM joined_df\n-- LIMIT 10\n\"\"\")\ncsv_df.createOrReplaceTempView(\"csv_df\")","user":"anonymous","dateUpdated":"2020-04-01T01:38:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585700459500_1202105717","id":"20200401-002059_2104237136","dateCreated":"2020-04-01T00:20:59+0000","dateStarted":"2020-04-01T01:38:33+0000","dateFinished":"2020-04-01T01:38:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:418"},{"text":"%pyspark\ncsv_df.show(10)","user":"anonymous","dateUpdated":"2020-04-01T01:41:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------------------+----+----------+----+\n|genre|               title|year|avg_rating|rank|\n+-----+--------------------+----+----------+----+\n|Crime|       The Swindlers|2017|       5.0|   1|\n|Crime|     The Last Bullet|1973|       5.0|   2|\n|Crime|A Police Inspecto...|1974|       5.0|   3|\n|Crime|             Revenge|1978|       5.0|   4|\n|Crime|    Shor in the City|2011|       5.0|   5|\n|Crime|            Baseline|2010|       5.0|   6|\n|Crime|            The Duel|1981|       5.0|   7|\n|Crime|            Hooligan|1998|       5.0|   8|\n|Crime|The Perfect Assis...|2008|       5.0|   9|\n|Crime|Dusty and Sweets ...|1971|       5.0|  10|\n+-----+--------------------+----+----------+----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585700649350_-197680586","id":"20200401-002409_227636342","dateCreated":"2020-04-01T00:24:09+0000","dateStarted":"2020-04-01T01:38:34+0000","dateFinished":"2020-04-01T01:39:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:419"},{"text":"%sql\nSELECT *,\nROW_NUMBER() OVER (PARTITION BY genre ORDER BY avg_rating DESC) AS  rank\nFROM joined_df\nLIMIT 10\n\n\n","user":"anonymous","dateUpdated":"2020-04-01T01:41:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"genre":"string","title":"string","year":"string","avg_rating":"string","rank":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"collect_list(title)","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttitle\tyear\tavg_rating\trank\nCrime\tThe Swindlers\t2017\t5.0\t1\nCrime\tThe Last Bullet\t1973\t5.0\t2\nCrime\tA Police Inspector Calls\t1974\t5.0\t3\nCrime\tBaseline\t2010\t5.0\t4\nCrime\tHooligan\t1998\t5.0\t5\nCrime\tThe Perfect Assistant\t2008\t5.0\t6\nCrime\tTwisted Desire\t1996\t5.0\t7\nCrime\tDissolved and Effused\t1985\t5.0\t8\nCrime\tHart to Hart: Till Death Do Us Hart\t1996\t5.0\t9\nCrime\tOne Way Out\t2002\t5.0\t10\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585685996114_-186277087","id":"20200331-201956_852385739","dateCreated":"2020-03-31T20:19:56+0000","dateStarted":"2020-04-01T01:39:10+0000","dateFinished":"2020-04-01T01:39:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:420"},{"text":"%pyspark\n\nfinal_df = spark.sql(\"\"\"\nSELECT genre,\ntitle,\nyear,\navg_rating\nFROM csv_df\nWHERE rank <={N}\nORDER BY genre ASC, avg_rating DESC\n\"\"\").format(N)\n","user":"anonymous","dateUpdated":"2020-04-01T09:27:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585700666651_-1484951100","id":"20200401-002426_2011643975","dateCreated":"2020-04-01T00:24:26+0000","dateStarted":"2020-04-01T01:39:44+0000","dateFinished":"2020-04-01T01:39:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:421"},{"text":"%pyspark\nfinal_df.show()","user":"anonymous","dateUpdated":"2020-04-01T01:41:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+--------------------+----+----------+\n|             genre|               title|year|avg_rating|\n+------------------+--------------------+----+----------+\n|(no genres listed)|    The Pilot's Wife|2005|       5.0|\n|(no genres listed)|          Mary & Tim|1996|       5.0|\n|(no genres listed)|Ram Dass: Fierce ...|2001|       5.0|\n|(no genres listed)|        Aschenputtel|1989|       5.0|\n|(no genres listed)|Never Tear Us Apa...|2014|       5.0|\n|            Action|     The Last Bullet|1973|       5.0|\n|            Action|  Day of the Panther|1988|       5.0|\n|            Action|A Police Inspecto...|1974|       5.0|\n|            Action|              Khushi|2001|       5.0|\n|            Action|        Pony Express|1953|       5.0|\n|         Adventure|         Windstorm 2|2015|       5.0|\n|         Adventure|       I Spy Returns|1994|       5.0|\n|         Adventure|           War Arrow|1954|       5.0|\n|         Adventure|Temple of the Whi...|1964|       5.0|\n|         Adventure|Goliath and the S...|1963|       5.0|\n|         Animation|          Free Jimmy|2006|       5.0|\n|         Animation|Lotte and the Moo...|2011|       5.0|\n|         Animation|The Story of Anyb...|1957|       5.0|\n|         Animation|Step Up Love Stor...|2002|      4.75|\n|         Animation|Manieggs - Reveng...|2014|       4.5|\n+------------------+--------------------+----+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585704283467_-1897810733","id":"20200401-012443_1286407800","dateCreated":"2020-04-01T01:24:43+0000","dateStarted":"2020-04-01T01:39:45+0000","dateFinished":"2020-04-01T01:40:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:422"},{"text":"%sql\n\nSELECT genre,\ntitle,\nyear,\navg_rating\nFROM csv_df\nWHERE rank <=5\nORDER BY genre ASC, avg_rating DESC","user":"anonymous","dateUpdated":"2020-04-01T01:41:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"genre":"string","title":"string","year":"string","avg_rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"title","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttitle\tyear\tavg_rating\n(no genres listed)\tSondheim! The Birthday Concert\t2010\t5.0\n(no genres listed)\tNever Tear Us Apart: The Untold Story of INXS\t2014\t5.0\n(no genres listed)\tAschenputtel\t1989\t5.0\n(no genres listed)\tKino-pravda no. 9\t1922\t5.0\n(no genres listed)\tMary & Tim\t1996\t5.0\nAction\tFB: Fighting Beat\t2007\t5.0\nAction\tDay of the Panther\t1988\t5.0\nAction\tThe Last Bullet\t1973\t5.0\nAction\tCaptain Blood (Le capitan) (Invincible Swordsman, The)\t1960\t5.0\nAction\tA Police Inspector Calls\t1974\t5.0\nAdventure\tCaptain Blood (Le capitan) (Invincible Swordsman, The)\t1960\t5.0\nAdventure\tWindstorm 2\t2015\t5.0\nAdventure\tFuture Hunters\t1986\t5.0\nAdventure\tThe Viking\t1931\t5.0\nAdventure\tHands of a Murderer\t1990\t5.0\nAnimation\tLotte and the Moonstone Secret\t2011\t5.0\nAnimation\tThe Story of Anyburg U.S.A.\t1957\t5.0\nAnimation\tFree Jimmy\t2006\t5.0\nAnimation\tStep Up Love Story (Futari ecchi)\t2002\t4.75\nAnimation\tThe Little Engine That Could\t2011\t4.5\nChildren\tTony 10\t2012\t5.0\nChildren\tThe King and Queen of Moonlight Bay\t2003\t5.0\nChildren\tWindstorm 2\t2015\t5.0\nChildren\tBound & Babysitting\t2015\t5.0\nChildren\tRoxy Hunter and the Secret of the Shaman\t2008\t5.0\nComedy\tInquire Within\t2012\t5.0\nComedy\tHumpty Sharma Ki Dulhania\t2014\t5.0\nComedy\tThe Biggest Fan\t2002\t5.0\nComedy\tKryptonite!\t2011\t5.0\nComedy\tPeacock\t2015\t5.0\nCrime\tThe Last Bullet\t1973\t5.0\nCrime\tShor in the City\t2011\t5.0\nCrime\tBaseline\t2010\t5.0\nCrime\tA Police Inspector Calls\t1974\t5.0\nCrime\tRevenge\t1978\t5.0\nDocumentary\tPeople of a Feather\t2012\t5.0\nDocumentary\tHijacking Catastrophe: 9/11, Fear & the Selling of American Empire\t2004\t5.0\nDocumentary\tMatrix of Evil\t2003\t5.0\nDocumentary\tWelcome to Australia\t1999\t5.0\nDocumentary\tBeatles Stories\t2011\t5.0\nDrama\tPeacock\t2015\t5.0\nDrama\tThe King and Queen of Moonlight Bay\t2003\t5.0\nDrama\tHumpty Sharma Ki Dulhania\t2014\t5.0\nDrama\tKryptonite!\t2011\t5.0\nDrama\tQueen of Carthage\t2013\t5.0\nFantasy\tEdge of the Garden\t2011\t5.0\nFantasy\tRocaterrania\t2009\t5.0\nFantasy\tDie Salzprinzessin\t2015\t5.0\nFantasy\tKönig Drosselbart\t2008\t5.0\nFantasy\tSechse kommen durch die ganze Welt\t2014\t5.0\nFilm-Noir\tDouble Indemnity\t1944\t4.2\nFilm-Noir\tSunset Blvd. (a.k.a. Sunset Boulevard)\t1950\t4.2\nFilm-Noir\tThird Man, The\t1949\t4.2\nFilm-Noir\tM\t1931\t4.16\nFilm-Noir\tNotorious\t1946\t4.16\nHorror\tSiccîn\t2014\t5.0\nHorror\tAb-normal Beauty\t2004\t5.0\nHorror\tWolfguy - Enraged Lycanthrope\t1975\t5.0\nHorror\tDespite the Night\t2015\t5.0\nHorror\tVon einem, der auszog, das Fürchten zu lernen\t2014\t5.0\nIMAX\tDark Knight, The\t2008\t4.17\nIMAX\tInception\t2010\t4.16\nIMAX\tInterstellar\t2014\t4.09\nIMAX\tDark Knight Rises, The\t2012\t3.98\nIMAX\tEdge of Tomorrow\t2014\t3.94\nMusical\tComin' Round the Mountain\t1951\t5.0\nMusical\tLatin Music USA\t2009\t5.0\nMusical\tListen Darling\t1938\t4.75\nMusical\t2013 Rock and Roll Hall of Fame Induction Ceremony, The\t2013\t4.5\nMusical\tLet the Good Times Roll\t1973\t4.5\nMystery\tPoison\t2000\t5.0\nMystery\tRoxy Hunter and the Secret of the Shaman\t2008\t5.0\nMystery\tSay Nothing\t2001\t5.0\nMystery\tThe Duel\t1981\t5.0\nMystery\tDespite the Night\t2015\t5.0\nRomance\tPeacock\t2015\t5.0\nRomance\tI've Heard the Mermaids Singing\t1987\t5.0\nRomance\tThe Biggest Fan\t2002\t5.0\nRomance\tAnd Love Has Vanished\t1961\t5.0\nRomance\tHumpty Sharma Ki Dulhania\t2014\t5.0\nSci-Fi\tSay Nothing\t2001\t5.0\nSci-Fi\tAwaken\t2013\t5.0\nSci-Fi\tElectric Nostalgia\t2016\t5.0\nSci-Fi\tThe Hexer\t2001\t5.0\nSci-Fi\tPale\t2016\t5.0\nThriller\tQueen of Carthage\t2013\t5.0\nThriller\tThe Hunt for the Unicorn Killer\t1999\t5.0\nThriller\tThe Last Bullet\t1973\t5.0\nThriller\tTwisted Seduction\t2010\t5.0\nThriller\tPoison\t2000\t5.0\nWar\tThe Undefeated\t2000\t5.0\nWar\tWar Arrow\t1954\t5.0\nWar\tIn the Meantime, Darling\t1944\t5.0\nWar\tThe Last Hunter\t1980\t5.0\nWar\tUntil They Sail\t1957\t5.0\nWestern\tLonesome Dove Church\t2014\t5.0\nWestern\tPony Express\t1953\t5.0\nWestern\tWar Arrow\t1954\t5.0\nWestern\tClearcut\t1991\t5.0\nWestern\tRio Diablo\t1993\t5.0\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1585694626355_-1313231998","id":"20200331-224346_722474933","dateCreated":"2020-03-31T22:43:46+0000","dateStarted":"2020-04-01T01:40:19+0000","dateFinished":"2020-04-01T01:40:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:423"},{"text":"%pyspark\nfinal_df.repartition(1).write.csv(path=output_dir,\n             mode=\"overwrite\", \n             sep=\",\", \n             header=True)\n    # .format('csv') \\\n    # .option('header', 'true') \\\n    # .option('delimiter', ',') \\\n    # .option('encoding', 'utf-8') \\\n    # .option('path', output_dir) \\\n    # .save(\"test\")\n    # .saveAsTable('movies_mapped_and_filtered')","user":"anonymous","dateUpdated":"2020-04-01T01:40:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585701033152_1964078096","id":"20200401-003033_1912777675","dateCreated":"2020-04-01T00:30:33+0000","dateStarted":"2020-04-01T01:40:51+0000","dateFinished":"2020-04-01T01:41:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:424"},{"text":"%sh\n\n# hdfs dfs -rm -r /user/zeppelin/sparkSQL/output","user":"anonymous","dateUpdated":"2020-04-01T01:41:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585704316110_-1311671114","id":"20200401-012516_2141956428","dateCreated":"2020-04-01T01:25:16+0000","dateStarted":"2020-04-01T01:41:27+0000","dateFinished":"2020-04-01T01:41:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:425"},{"text":"%sh\n\nhdfs dfs -ls /user/zeppelin/sparkSQL/output","user":"anonymous","dateUpdated":"2020-04-01T01:41:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 2 items\n-rw-r--r--   2 zeppelin hadoop          0 2020-04-01 01:41 /user/zeppelin/sparkSQL/output/_SUCCESS\n-rw-r--r--   2 zeppelin hadoop       3725 2020-04-01 01:41 /user/zeppelin/sparkSQL/output/part-00000-4634dab7-bc84-4446-8121-b8c93af6e8be-c000.csv\n"}]},"apps":[],"jobName":"paragraph_1585701060083_-308109372","id":"20200401-003100_251126736","dateCreated":"2020-04-01T00:31:00+0000","dateStarted":"2020-04-01T01:41:27+0000","dateFinished":"2020-04-01T01:41:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:426"},{"text":"%sh\n\nhdfs dfs -cat /user/zeppelin/sparkSQL/output/*0.csv","user":"anonymous","dateUpdated":"2020-04-01T01:41:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"genre,title,year,avg_rating\n(no genres listed),The Pilot's Wife,2005,5.0\n(no genres listed),Kino-pravda no. 8,1922,5.0\n(no genres listed),Women from the Lake of Scented Souls,1993,5.0\n(no genres listed),A Boring Story,1983,5.0\n(no genres listed),Sondheim! The Birthday Concert,2010,5.0\nAction,Dragon Lee Vs. The 5 Brothers,1978,5.0\nAction,Drunken Master 3,1994,5.0\nAction,I Spy Returns,1994,5.0\nAction,Day of the Panther,1988,5.0\nAction,The Last Bullet,1973,5.0\nAdventure,War Arrow,1954,5.0\nAdventure,\"Captain Blood (Le capitan) (Invincible Swordsman, The)\",1960,5.0\nAdventure,Azit the Paratrooper Dog,1972,5.0\nAdventure,The Hexer,2001,5.0\nAdventure,Hercules Against the Mongols,1963,5.0\nAnimation,The Story of Anyburg U.S.A.,1957,5.0\nAnimation,Free Jimmy,2006,5.0\nAnimation,Lotte and the Moonstone Secret,2011,5.0\nAnimation,Step Up Love Story (Futari ecchi),2002,4.75\nAnimation,The Little Engine That Could,2011,4.5\nChildren,Tony 10,2012,5.0\nChildren,Rosa: The Movie,2007,5.0\nChildren,The King and Queen of Moonlight Bay,2003,5.0\nChildren,Snow White,1987,5.0\nChildren,Roxy Hunter and the Secret of the Shaman,2008,5.0\nComedy,Living on Love,1937,5.0\nComedy,Brad Williams: Daddy Issues,2016,5.0\nComedy,Russell Peters - Comedy Now!,2004,5.0\nComedy,Fatty Finn,1980,5.0\nComedy,The Lost Letter,1972,5.0\nCrime,The Swindlers,2017,5.0\nCrime,The Last Bullet,1973,5.0\nCrime,A Police Inspector Calls,1974,5.0\nCrime,Revenge,1978,5.0\nCrime,Shor in the City,2011,5.0\nDrama,Windstorm 2,2015,5.0\nDrama,A Man To Remember,1938,5.0\nDrama,Humpty Sharma Ki Dulhania,2014,5.0\nDrama,Kryptonite!,2011,5.0\nDrama,Peacock,2015,5.0\nFantasy,Rocaterrania,2009,5.0\nFantasy,Assepoester: Een Modern Sprookje,2014,5.0\nFantasy,Die Salzprinzessin,2015,5.0\nFantasy,Die Gänsemagd,2009,5.0\nFantasy,The Pill,1972,5.0\nFilm-Noir,Double Indemnity,1944,4.2\nFilm-Noir,Sunset Blvd. (a.k.a. Sunset Boulevard),1950,4.2\nFilm-Noir,\"Third Man, The\",1949,4.2\nFilm-Noir,\"Big Sleep, The\",1946,4.16\nFilm-Noir,M,1931,4.16\nHorror,Horror Stories 2,2013,5.0\nHorror,Siccîn,2014,5.0\nHorror,Ab-normal Beauty,2004,5.0\nHorror,\"Von einem, der auszog, das Fürchten zu lernen\",2014,5.0\nHorror,Dark Asylum,2001,5.0\nMusical,Comin' Round the Mountain,1951,5.0\nMusical,Latin Music USA,2009,5.0\nMusical,Listen Darling,1938,4.75\nMusical,Let the Good Times Roll,1973,4.5\nMusical,Never Make It Home,2011,4.5\nMystery,Despite the Night,2015,5.0\nMystery,Witness for the Prosecution,1982,5.0\nMystery,The Duel,1981,5.0\nMystery,The Perfect Assistant,2008,5.0\nMystery,Hush Little Baby,2007,5.0\nRomance,Humpty Sharma Ki Dulhania,2014,5.0\nRomance,The Biggest Fan,2002,5.0\nRomance,Peacock,2015,5.0\nRomance,And Love Has Vanished,1961,5.0\nRomance,I've Heard the Mermaids Singing,1987,5.0\nThriller,Queen of Carthage,2013,5.0\nThriller,The Last Bullet,1973,5.0\nThriller,\"Love, Cheat & Steal\",1993,5.0\nThriller,A Job to Kill For,2006,5.0\nThriller,Sexting in Suburbia,2012,5.0\nIMAX,\"Dark Knight, The\",2008,4.17\nIMAX,Inception,2010,4.16\nIMAX,\"Dark Knight Rises, The\",2012,3.98\nSci-Fi,Say Nothing,2001,5.0\nSci-Fi,Night Key,1937,5.0\nSci-Fi,Awaken,2013,5.0\nSci-Fi,The Hexer,2001,5.0\nSci-Fi,Pale,2016,5.0\nWestern,Pony Express,1953,5.0\nWestern,Lonesome Dove Church,2014,5.0\nWestern,War Arrow,1954,5.0\nWestern,The Last Hunt,1956,5.0\nWestern,Rio Diablo,1993,5.0\nDocumentary,People of a Feather,2012,5.0\nDocumentary,Matrix of Evil,2003,5.0\nDocumentary,Welcome to Australia,1999,5.0\nDocumentary,Beatles Stories,2011,5.0\nDocumentary,\"Hijacking Catastrophe: 9/11, Fear & the Selling of American Empire\",2004,5.0\nIMAX,Interstellar,2014,4.09\nIMAX,Edge of Tomorrow,2014,3.94\nWar,\"In the Meantime, Darling\",1944,5.0\nWar,Until They Sail,1957,5.0\nWar,War Arrow,1954,5.0\nWar,Keep 'Em Flying,1941,5.0\nWar,Appointment in Bray,1971,5.0\n"}]},"apps":[],"jobName":"paragraph_1585701071403_927485444","id":"20200401-003111_350802253","dateCreated":"2020-04-01T00:31:11+0000","dateStarted":"2020-04-01T01:41:30+0000","dateFinished":"2020-04-01T01:41:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:427"}],"name":"Issoft/pyspark-topN-movies(SQL)","id":"2F774QZR6","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}