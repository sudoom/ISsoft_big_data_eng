{"paragraphs":[{"text":"[%sh\n\n# if [[-d /tmp/ml-latest]]; then\n#     rm -fr /tmp/ml-latest\n#     echo \"Removed existing folder\"\n# fi\n\nwget -q -O /tmp/ml-latest.zip http://files.grouplens.org/datasets/movielens/ml-latest.zip\necho \"Dowloaded ml-latest.zip ...\"\n\nunzip /tmp/ml-latest.zip -d /tmp/\nrm /tmp/ml-latest.zip\necho \"Unpacked ml-latest.zip ...\"\n\ndir0=/tmp/datalake\ndir1=links\ndir2=movies\ndir3=ratings\ndir4=tags\ndir5=/user/zeppelin/sparkSQL/input\n\nfor dir in $dir1 $dir2 $dir3 $dir4;do\n# if [[-d $dir0/$dir]]; then\n#     rm -r $dir0/$dir1\n# fi\n    mkdir -p $dir0/$dir\n    \n    mv /tmp/ml-latest/$dir.csv $dir0/$dir/\n    echo \"Moved $dir.csv to $dir0/$dir/ ...\"\ndone\n\nrm -r /tmp/ml-latest\necho \"Datalake files created!\"\n\nhdfs dfs -mkdir -p $dir5\necho \"Directory $dir5 created in hdfs\"\nhdfs dfs -put -f $dir0/$dir3/$dir3.csv $dir0/$dir2/$dir2.csv $dir5\necho \"Copy $dir3.csv to hdfs://$dir5 complete\"\necho \"Copy $dir2.csv to hdfs://$dir5 complete\"","user":"anonymous","dateUpdated":"2020-04-01T21:15:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Dowloaded ml-latest.zip ...\nArchive:  /tmp/ml-latest.zip\n   creating: /tmp/ml-latest/\n  inflating: /tmp/ml-latest/links.csv  \n  inflating: /tmp/ml-latest/tags.csv  \n  inflating: /tmp/ml-latest/genome-tags.csv  \n  inflating: /tmp/ml-latest/ratings.csv  \n  inflating: /tmp/ml-latest/README.txt  \n  inflating: /tmp/ml-latest/genome-scores.csv  \n  inflating: /tmp/ml-latest/movies.csv  \nUnpacked ml-latest.zip ...\nMoved links.csv to /tmp/datalake/links/ ...\nMoved movies.csv to /tmp/datalake/movies/ ...\nMoved ratings.csv to /tmp/datalake/ratings/ ...\nMoved tags.csv to /tmp/datalake/tags/ ...\nDatalake files created!\nDirectory /user/zeppelin/sparkSQL/input created in hdfs\nCopy ratings.csv to hdfs:///user/zeppelin/sparkSQL/input complete\nCopy movies.csv to hdfs:///user/zeppelin/sparkSQL/input complete\n"}]},"apps":[],"jobName":"paragraph_1585673000976_-1527733237","id":"20200331-164320_744840500","dateCreated":"2020-03-31T16:43:20+0000","dateStarted":"2020-04-01T17:30:43+0000","dateFinished":"2020-04-01T17:31:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:135720"},{"text":"%pyspark\n\n# parametres\n\nN = 5\nmovies_file = \"hdfs:///user/zeppelin/sparkSQL/input/movies.csv\"\nratings_file = \"hdfs:///user/zeppelin/sparkSQL/input/ratings.csv\"\noutput_dir = \"hdfs:///user/zeppelin/sparkSQL/output\"","user":"anonymous","dateUpdated":"2020-04-01T20:50:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585673031519_-1356826905","id":"20200331-164351_1149227292","dateCreated":"2020-03-31T16:43:51+0000","dateStarted":"2020-04-01T20:50:23+0000","dateFinished":"2020-04-01T20:50:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135721"},{"text":"%sql\n\nCREATE TABLE movies (\n    movieId INT, \n    title STRING, \n    genres STRING\n    )\nUSING csv\nOPTIONS (HEADER=TRUE, \n         PATH=\"hdfs:///user/zeppelin/sparkSQL/input/movies.csv\")\n","user":"anonymous","dateUpdated":"2020-04-01T17:39:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585761512823_491884556","id":"20200401-171832_1811472920","dateCreated":"2020-04-01T17:18:32+0000","dateStarted":"2020-04-01T17:32:52+0000","dateFinished":"2020-04-01T17:33:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135724","errorMessage":""},{"text":"%sql\n\nselect * from movies limit 10 \n","user":"anonymous","dateUpdated":"2020-04-01T21:22:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","title":"string","genres":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"movieId","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"title","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\ttitle\tgenres\n1\tToy Story (1995)\tAdventure|Animation|Children|Comedy|Fantasy\n2\tJumanji (1995)\tAdventure|Children|Fantasy\n3\tGrumpier Old Men (1995)\tComedy|Romance\n4\tWaiting to Exhale (1995)\tComedy|Drama|Romance\n5\tFather of the Bride Part II (1995)\tComedy\n6\tHeat (1995)\tAction|Crime|Thriller\n7\tSabrina (1995)\tComedy|Romance\n8\tTom and Huck (1995)\tAdventure|Children\n9\tSudden Death (1995)\tAction\n10\tGoldenEye (1995)\tAction|Adventure|Thriller\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=89"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585673481639_-246844721","id":"20200331-165121_1117202403","dateCreated":"2020-03-31T16:51:21+0000","dateStarted":"2020-04-01T21:22:54+0000","dateFinished":"2020-04-01T21:22:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135726","focus":true},{"text":"%sql\n\nCREATE TABLE ratings (\n    userId INT,\n    movieId INT, \n    rating FLOAT\n    )\nUSING csv\nOPTIONS (HEADER=TRUE, \n         PATH=\"hdfs:///user/zeppelin/sparkSQL/input/ratings.csv\")","user":"anonymous","dateUpdated":"2020-04-01T17:41:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585762264795_-1443585288","id":"20200401-173104_251678283","dateCreated":"2020-04-01T17:31:04+0000","dateStarted":"2020-04-01T17:41:22+0000","dateFinished":"2020-04-01T17:41:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135725","errorMessage":""},{"text":"%sql\n\nselect * from ratings limit 10","user":"anonymous","dateUpdated":"2020-04-01T21:23:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"userId":"string","movieId":"string","rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"userId\tmovieId\trating\n1\t307\t3.5\n1\t481\t3.5\n1\t1091\t1.5\n1\t1257\t4.5\n1\t1449\t4.5\n1\t1590\t2.5\n1\t1591\t1.5\n1\t2134\t4.5\n1\t2478\t4.0\n1\t2840\t3.0\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=90"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585673604844_311577595","id":"20200331-165324_648680830","dateCreated":"2020-03-31T16:53:24+0000","dateStarted":"2020-04-01T21:23:03+0000","dateFinished":"2020-04-01T21:23:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135727"},{"text":"%sql\n\nCREATE TABLE ratings_normalized AS (\n    SELECT movieId, \n           round(avg(rating), 2) AS avg_rating\n    FROM ratings \n    GROUP BY movieId\n    )","user":"anonymous","dateUpdated":"2020-04-01T17:48:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585762917383_1201166278","id":"20200401-174157_1904121938","dateCreated":"2020-04-01T17:41:57+0000","dateStarted":"2020-04-01T17:48:34+0000","dateFinished":"2020-04-01T17:49:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135728","errorMessage":""},{"text":"%sql\n\nSELECT * FROM ratings_normalized LIMIT 10","user":"anonymous","dateUpdated":"2020-04-01T21:23:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","avg_rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\tavg_rating\n1591\t2.65\n1645\t3.54\n471\t3.65\n1088\t3.25\n1580\t3.58\n3997\t2.07\n3175\t3.59\n6620\t3.79\n2122\t2.65\n2142\t3.05\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=91"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585763162474_-971310913","id":"20200401-174602_1212935405","dateCreated":"2020-04-01T17:46:02+0000","dateStarted":"2020-04-01T21:23:11+0000","dateFinished":"2020-04-01T21:23:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135729"},{"text":"%sql\n\nCREATE TABLE movies_normalized AS (\n    SELECT movieId,\n           REGEXP_EXTRACT(title, \"(.+)[ ]+\\\\((\\\\d{4})\\\\)\", 1) AS title,\n           REGEXP_EXTRACT(title, '(.+)[ ]+\\\\((\\\\d{4})\\\\)', 2) AS year,\n           EXPLODE(SPLIT(genres, \"[|]\")) AS genre\n    FROM movies\n    )","user":"anonymous","dateUpdated":"2020-04-01T17:55:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585763199617_2038488242","id":"20200401-174639_538997905","dateCreated":"2020-04-01T17:46:39+0000","dateStarted":"2020-04-01T17:55:04+0000","dateFinished":"2020-04-01T17:55:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135730","errorMessage":""},{"text":"%sql\n\nSELECT * FROM movies_normalized LIMIT 10","user":"anonymous","dateUpdated":"2020-04-01T21:23:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","title":"string","year":"string","genre":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\ttitle\tyear\tgenre\n1\tToy Story\t1995\tAdventure\n1\tToy Story\t1995\tAnimation\n1\tToy Story\t1995\tChildren\n1\tToy Story\t1995\tComedy\n1\tToy Story\t1995\tFantasy\n2\tJumanji\t1995\tAdventure\n2\tJumanji\t1995\tChildren\n2\tJumanji\t1995\tFantasy\n3\tGrumpier Old Men\t1995\tComedy\n3\tGrumpier Old Men\t1995\tRomance\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=92"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585763212774_986520753","id":"20200401-174652_75175163","dateCreated":"2020-04-01T17:46:52+0000","dateStarted":"2020-04-01T21:23:21+0000","dateFinished":"2020-04-01T21:23:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135733"},{"text":"%sql\n\nCREATE TABLE movies_nullable_title_year AS (\n    SELECT movieId,\n           genre,\n    CASE\n        WHEN ( title != \"\") THEN title\n        ELSE NULL\n           END AS title,\n    CASE\n        WHEN ( year != \"\") THEN year\n        ELSE NULL\n           END AS year\n    FROM movies_normalized\n    )\n\n","user":"anonymous","dateUpdated":"2020-04-01T18:01:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585701337835_1834211864","id":"20200401-003537_1825540249","dateCreated":"2020-04-01T00:35:37+0000","dateStarted":"2020-04-01T18:01:22+0000","dateFinished":"2020-04-01T18:01:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135734","errorMessage":""},{"text":"%sql\n\nSELECT * FROM movies_nullable_title_year LIMIT 10","user":"anonymous","dateUpdated":"2020-04-01T21:23:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","genre":"string","title":"string","year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\tgenre\ttitle\tyear\n1\tAdventure\tToy Story\t1995\n1\tAnimation\tToy Story\t1995\n1\tChildren\tToy Story\t1995\n1\tComedy\tToy Story\t1995\n1\tFantasy\tToy Story\t1995\n2\tAdventure\tJumanji\t1995\n2\tChildren\tJumanji\t1995\n2\tFantasy\tJumanji\t1995\n3\tComedy\tGrumpier Old Men\t1995\n3\tRomance\tGrumpier Old Men\t1995\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=93"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585764054635_282404242","id":"20200401-180054_938707388","dateCreated":"2020-04-01T18:00:54+0000","dateStarted":"2020-04-01T21:23:32+0000","dateFinished":"2020-04-01T21:23:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135735"},{"text":"%sql\n\nCREATE TABLE movies_blanked AS (\n    SELECT *\n    FROM movies_nullable_title_year\n    WHERE title IS NOT NULL OR year IS NOT NULL\n)","user":"anonymous","dateUpdated":"2020-04-01T18:04:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585703009113_-1900985023","id":"20200401-010329_5507136","dateCreated":"2020-04-01T01:03:29+0000","dateStarted":"2020-04-01T18:04:11+0000","dateFinished":"2020-04-01T18:04:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135736","errorMessage":""},{"text":"%sql\n\nSELECT * FROM movies_blanked LIMIT 10","user":"anonymous","dateUpdated":"2020-04-01T21:23:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","genre":"string","title":"string","year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\tgenre\ttitle\tyear\n1\tAdventure\tToy Story\t1995\n1\tAnimation\tToy Story\t1995\n1\tChildren\tToy Story\t1995\n1\tComedy\tToy Story\t1995\n1\tFantasy\tToy Story\t1995\n2\tAdventure\tJumanji\t1995\n2\tChildren\tJumanji\t1995\n2\tFantasy\tJumanji\t1995\n3\tComedy\tGrumpier Old Men\t1995\n3\tRomance\tGrumpier Old Men\t1995\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=94"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585764203800_-226174904","id":"20200401-180323_1466848134","dateCreated":"2020-04-01T18:03:23+0000","dateStarted":"2020-04-01T21:23:40+0000","dateFinished":"2020-04-01T21:23:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135737"},{"text":"%sql\n\nCREATE TABLE joined AS (\n    SELECT genre,\n           title,\n           year,\n           avg_rating\n    FROM movies_blanked\n    JOIN ratings_normalized\n    ON movies_blanked.movieId=ratings_normalized.movieId\n    )\n","user":"anonymous","dateUpdated":"2020-04-01T18:07:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585685766514_1798882034","id":"20200331-201606_1869905854","dateCreated":"2020-03-31T20:16:06+0000","dateStarted":"2020-04-01T18:07:32+0000","dateFinished":"2020-04-01T18:07:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135738","errorMessage":""},{"text":"%sql\nSELECT * FROM joined LIMIT 10","user":"anonymous","dateUpdated":"2020-04-01T21:23:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"genre":"string","title":"string","year":"string","avg_rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttitle\tyear\tavg_rating\nAdventure\tToy Story\t1995\t3.89\nAnimation\tToy Story\t1995\t3.89\nChildren\tToy Story\t1995\t3.89\nComedy\tToy Story\t1995\t3.89\nFantasy\tToy Story\t1995\t3.89\nAdventure\tJumanji\t1995\t3.25\nChildren\tJumanji\t1995\t3.25\nFantasy\tJumanji\t1995\t3.25\nComedy\tGrumpier Old Men\t1995\t3.17\nRomance\tGrumpier Old Men\t1995\t3.17\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=95"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585764471644_-818417531","id":"20200401-180751_1613630587","dateCreated":"2020-04-01T18:07:51+0000","dateStarted":"2020-04-01T21:23:50+0000","dateFinished":"2020-04-01T21:23:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135739"},{"text":"%sql\nCREATE TABLE to_csv AS (\n    SELECT *,\n           ROW_NUMBER() OVER (PARTITION BY genre ORDER BY avg_rating DESC) AS  rank\n    FROM joined\n    )","user":"anonymous","dateUpdated":"2020-04-01T18:10:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"collect_list(title)","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585685996114_-186277087","id":"20200331-201956_852385739","dateCreated":"2020-03-31T20:19:56+0000","dateStarted":"2020-04-01T18:10:12+0000","dateFinished":"2020-04-01T18:10:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135740","errorMessage":""},{"text":"%sql\nSELECT * FROM to_csv LIMIT 10","user":"anonymous","dateUpdated":"2020-04-01T21:24:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"genre":"string","title":"string","year":"string","avg_rating":"string","rank":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttitle\tyear\tavg_rating\trank\nCrime\tTempo\t2003\t5.0\t1\nCrime\tStyx\t2001\t5.0\t2\nCrime\tThe Capture of the Green River Killer\t2008\t5.0\t3\nCrime\tA Police Inspector Calls\t1974\t5.0\t4\nCrime\tRevenge\t1978\t5.0\t5\nCrime\tThe Duel\t1981\t5.0\t6\nCrime\tThe Last Bullet\t1973\t5.0\t7\nCrime\tOne Way Out\t2002\t5.0\t8\nCrime\tThe Perfect Assistant\t2008\t5.0\t9\nCrime\tTwisted Desire\t1996\t5.0\t10\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=96","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=97"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585764506620_591093472","id":"20200401-180826_1790269523","dateCreated":"2020-04-01T18:08:26+0000","dateStarted":"2020-04-01T21:23:59+0000","dateFinished":"2020-04-01T21:24:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135741"},{"text":"%sql\nCREATE TABLE final\nUSING csv\nOPTIONS (HEADER=TRUE, \n         MODE=\"overwrite\",\n         PATH=\"hdfs:///user/zeppelin/sparkSQL/output\")\nAS (\n    SELECT genre,\n           title,\n           year,\n           avg_rating\n    FROM to_csv\n    WHERE rank <=5\n    ORDER BY genre ASC, \n             avg_rating DESC\n    )\nDISTRIBUTE BY 1\n","user":"anonymous","dateUpdated":"2020-04-01T20:07:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"title","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","lineNumbers":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585694626355_-1313231998","id":"20200331-224346_722474933","dateCreated":"2020-03-31T22:43:46+0000","dateStarted":"2020-04-01T20:03:15+0000","dateFinished":"2020-04-01T20:03:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135742","errorMessage":""},{"text":"%sql\nSELECT * FROM final","user":"anonymous","dateUpdated":"2020-04-01T21:24:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"genre":"string","title":"string","year":"string","avg_rating":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttitle\tyear\tavg_rating\nAnimation\tLotte and the Moonstone Secret\t2011\t5.0\nAnimation\tThe Story of Anyburg U.S.A.\t1957\t5.0\nAnimation\tFree Jimmy\t2006\t5.0\nIMAX\tDark Knight, The\t2008\t4.17\nIMAX\tInterstellar\t2014\t4.09\nIMAX\tEdge of Tomorrow\t2014\t3.94\nMystery\tPoison\t2000\t5.0\nMystery\tA Daughter's Nightmare\t2014\t5.0\nMystery\tA Sister's Revenge\t2013\t5.0\nMystery\tA Sister's Secret\t2009\t5.0\nMystery\tTainted Blood\t1993\t5.0\nThriller\tConvicted\t1931\t5.0\nThriller\tTurbulence 3: Heavy Metal\t2001\t5.0\nThriller\tThe Good Mother\t2013\t5.0\nThriller\tLast Sunset\t2006\t5.0\nThriller\tLove, Cheat & Steal\t1993\t5.0\n(no genres listed)\tPoster Girl\t2010\t5.0\n(no genres listed)\tLa vida sigue igual\t1969\t5.0\n(no genres listed)\tShark Kill\t1976\t5.0\n(no genres listed)\tMalibu Hot Summer\t1981\t5.0\n(no genres listed)\tGenius on Hold\t2013\t5.0\nAction\tThe Tattoo Connection\t1978\t5.0\nAction\tPony Express\t1953\t5.0\nAction\tHooligan\t1998\t5.0\nAction\tBaseline\t2010\t5.0\nAction\tI Spy Returns\t1994\t5.0\nAdventure\tTarzan's Savage Fury\t1952\t5.0\nAdventure\tTemple of the White Elephant\t1964\t5.0\nAdventure\tFuture Hunters\t1986\t5.0\nAdventure\tCaptain Blood (Le capitan) (Invincible Swordsman, The)\t1960\t5.0\nAdventure\tAzit the Paratrooper Dog\t1972\t5.0\nChildren\tFatty Finn\t1980\t5.0\nChildren\tGoing Attractions: The Definitive Story of the American Drive-in Movie\t2013\t5.0\nChildren\tSnow White\t1987\t5.0\nChildren\tLotte and the Moonstone Secret\t2011\t5.0\nChildren\tLove Finds You In Sugarcreek\t2014\t5.0\nCrime\tTempo\t2003\t5.0\nCrime\tStyx\t2001\t5.0\nCrime\tThe Capture of the Green River Killer\t2008\t5.0\nCrime\tA Police Inspector Calls\t1974\t5.0\nCrime\tRevenge\t1978\t5.0\nDocumentary\tHijacking Catastrophe: 9/11, Fear & the Selling of American Empire\t2004\t5.0\nDocumentary\tLatin Music USA\t2009\t5.0\nDocumentary\tJunior Prom\t1946\t5.0\nDocumentary\tSun Kissed\t2012\t5.0\nDocumentary\tDonos de Portugal\t2012\t5.0\nAnimation\tStep Up Love Story (Futari ecchi)\t2002\t4.75\nAnimation\tBagi, the Monster of Mighty Nature (Taishizen no makemono Bagi)\t1984\t4.5\nComedy\tBed of Roses\t1933\t5.0\nComedy\tInto the Middle of Nowhere\t2010\t5.0\nComedy\tInquire Within\t2012\t5.0\nComedy\tAt Ellen’s Age\t2011\t5.0\nComedy\tMen Don't Cry\t1968\t5.0\nFantasy\tRocaterrania\t2009\t5.0\nFantasy\tAschenputtel\t2010\t5.0\nFantasy\tThe Old Fairy Tale: When the Sun Was God\t2003\t5.0\nFantasy\tDie Gänsemagd\t2009\t5.0\nFantasy\tDornröschen\t2009\t5.0\nIMAX\tInception\t2010\t4.16\nDrama\tA Killing in a Small Town\t1990\t5.0\nDrama\tGeordie\t1955\t5.0\nDrama\tBlanche Fury\t1948\t5.0\nDrama\tUntil They Sail\t1957\t5.0\nDrama\tInvitation\t1952\t5.0\nFilm-Noir\tSunset Blvd. (a.k.a. Sunset Boulevard)\t1950\t4.2\nFilm-Noir\tThird Man, The\t1949\t4.2\nFilm-Noir\tDouble Indemnity\t1944\t4.2\nFilm-Noir\tNotorious\t1946\t4.16\nFilm-Noir\tM\t1931\t4.16\nHorror\tSiccîn\t2014\t5.0\nHorror\tMedium Raw\t2010\t5.0\nHorror\tVon einem, der auszog, das Fürchten zu lernen\t2014\t5.0\nHorror\tCaedes\t2015\t5.0\nHorror\tDark Asylum\t2001\t5.0\nMusical\tLatin Music USA\t2009\t5.0\nMusical\tComin' Round the Mountain\t1951\t5.0\nMusical\tListen Darling\t1938\t4.75\nMusical\tChocolate Soldier, The\t1941\t4.5\nMusical\t2013 Rock and Roll Hall of Fame Induction Ceremony, The\t2013\t4.5\nIMAX\tDark Knight Rises, The\t2012\t3.98\nRomance\tPursuit of Unhappiness, The (Anleitung zum Unglücklichsein)\t2012\t5.0\nRomance\tSins\t1986\t5.0\nRomance\tA Matter of Time\t1976\t5.0\nRomance\tLast Sunset\t2006\t5.0\nRomance\tMiracle in the Rain\t1956\t5.0\nSci-Fi\tThe Hexer\t2001\t5.0\nSci-Fi\tSay Nothing\t2001\t5.0\nSci-Fi\tAwaken\t2013\t5.0\nSci-Fi\tPale\t2016\t5.0\nSci-Fi\tElectric Nostalgia\t2016\t5.0\nWestern\tRio Diablo\t1993\t5.0\nWestern\tClearcut\t1991\t5.0\nWestern\tLonesome Dove Church\t2014\t5.0\nWestern\tPony Express\t1953\t5.0\nWestern\tThe Last Hunt\t1956\t5.0\nWar\tUntil They Sail\t1957\t5.0\nWar\tIn the Meantime, Darling\t1944\t5.0\nWar\tKeep 'Em Flying\t1941\t5.0\nWar\tWar Arrow\t1954\t5.0\nWar\tHitler\t1962\t5.0\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=98"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585764718015_-1492173778","id":"20200401-181158_1854613764","dateCreated":"2020-04-01T18:11:58+0000","dateStarted":"2020-04-01T21:24:08+0000","dateFinished":"2020-04-01T21:24:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135744"},{"text":"%pyspark\n\nspark.sql(\"\"\"\nCREATE TABLE movies (\n    movieId INT, \n    title STRING, \n    genres STRING\n    )\nUSING csv\nOPTIONS (HEADER=TRUE, \n         PATH=\"{}\")\n\"\"\".format(movies_file))\n\nspark.sql(\"\"\"\nCREATE TABLE ratings (\n    userId INT,\n    movieId INT, \n    rating FLOAT\n    )\nUSING csv\nOPTIONS (HEADER=TRUE, \n         PATH=\"{}\")\n\"\"\".format(ratings_file))\n\nspark.sql(\"\"\"\nCREATE TABLE ratings_normalized AS (\n    SELECT movieId, \n           round(avg(rating), 2) AS avg_rating\n    FROM ratings \n    GROUP BY movieId\n    )\n\"\"\")\n\nspark.sql(\"\"\"\nCREATE TABLE movies_normalized AS (\n    SELECT movieId,\n           REGEXP_EXTRACT(title, \"(.+)[ ]+[(](\\\\\\d{4})[)]\", 1) AS title,\n           REGEXP_EXTRACT(title, '(.+)[ ]+[(](\\\\\\d{4})[)]', 2) AS year,\n           EXPLODE(SPLIT(genres, \"[|]\")) AS genre\n    FROM movies\n    )\n\"\"\")\n\nspark.sql(\"\"\"\nCREATE TABLE movies_nullable_title_year AS (\n    SELECT movieId,\n           genre,\n    CASE\n        WHEN ( title != \"\") THEN title\n        ELSE NULL\n           END AS title,\n    CASE\n        WHEN ( year != \"\") THEN year\n        ELSE NULL\n           END AS year\n    FROM movies_normalized\n    )\n\"\"\")\n\nspark.sql(\"\"\"\nCREATE TABLE movies_blanked AS (\n    SELECT *\n    FROM movies_nullable_title_year\n    WHERE title IS NOT NULL OR year IS NOT NULL\n)\n\"\"\")\n\nspark.sql(\"\"\"\nCREATE TABLE joined AS (\n    SELECT genre,\n           title,\n           year,\n           avg_rating\n    FROM movies_blanked\n    JOIN ratings_normalized\n    ON movies_blanked.movieId=ratings_normalized.movieId\n    )\n\"\"\")\n\nspark.sql(\"\"\"\nCREATE TABLE to_csv AS (\n    SELECT *,\n           ROW_NUMBER() OVER (PARTITION BY genre ORDER BY avg_rating DESC) AS  rank\n    FROM joined\n    )\n\"\"\")\n\nspark.sql(\"\"\"\nCREATE TABLE final\nUSING csv\nOPTIONS (HEADER=TRUE, \n         MODE=\"overwrite\",\n         PATH=\"{0}\")\nAS (\n    SELECT genre,\n           title,\n           year,\n           avg_rating\n    FROM to_csv\n    WHERE rank <={1}\n    ORDER BY genre ASC, \n             avg_rating DESC\n    )\nDISTRIBUTE BY 1\n\"\"\".format(output_dir, N))\n","user":"anonymous","dateUpdated":"2020-04-01T21:27:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","lineNumbers":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=80","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=81","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=82","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=83","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=84","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=85","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=86","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=87","http://cluster-91cf-m.europe-west4-b.c.issoft-271914.internal:4040/jobs/job?id=88"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1585773348582_-2056536606","id":"20200401-203548_1343795605","dateCreated":"2020-04-01T20:35:48+0000","dateStarted":"2020-04-01T21:16:46+0000","dateFinished":"2020-04-01T21:17:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135723","focus":true},{"text":"%sh\n\n# hdfs dfs -rm -r /user/zeppelin/sparkSQL/output","user":"anonymous","dateUpdated":"2020-04-01T21:22:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /user/zeppelin/sparkSQL/output\n"}]},"apps":[],"jobName":"paragraph_1585704316110_-1311671114","id":"20200401-012516_2141956428","dateCreated":"2020-04-01T01:25:16+0000","dateStarted":"2020-04-01T21:11:16+0000","dateFinished":"2020-04-01T21:11:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135745"},{"text":"%sh\n\nhdfs dfs -ls /user/zeppelin/sparkSQL/output","user":"anonymous","dateUpdated":"2020-04-01T21:17:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 3 items\n-rw-r--r--   2 zeppelin hadoop          0 2020-04-01 21:17 /user/zeppelin/sparkSQL/output/_SUCCESS\n-rw-r--r--   2 zeppelin hadoop          0 2020-04-01 21:17 /user/zeppelin/sparkSQL/output/part-00000-22ed8627-701f-4934-b014-6b62943b60c7-c000.csv\n-rw-r--r--   2 zeppelin hadoop       3730 2020-04-01 21:17 /user/zeppelin/sparkSQL/output/part-00043-22ed8627-701f-4934-b014-6b62943b60c7-c000.csv\n"}]},"apps":[],"jobName":"paragraph_1585701060083_-308109372","id":"20200401-003100_251126736","dateCreated":"2020-04-01T00:31:00+0000","dateStarted":"2020-04-01T21:17:51+0000","dateFinished":"2020-04-01T21:17:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135746"},{"text":"%sh\n\nhdfs dfs -cat /user/zeppelin/sparkSQL/output/*00043*.csv","user":"anonymous","dateUpdated":"2020-04-01T21:18:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"genre,title,year,avg_rating\nAnimation,Lotte and the Moonstone Secret,2011,5.0\nAnimation,The Story of Anyburg U.S.A.,1957,5.0\nAnimation,Free Jimmy,2006,5.0\nIMAX,\"Dark Knight, The\",2008,4.17\nIMAX,Interstellar,2014,4.09\nIMAX,Edge of Tomorrow,2014,3.94\nMystery,Poison,2000,5.0\nMystery,A Daughter's Nightmare,2014,5.0\nMystery,A Sister's Revenge,2013,5.0\nMystery,A Sister's Secret,2009,5.0\nMystery,Tainted Blood,1993,5.0\nThriller,Convicted,1931,5.0\nThriller,Turbulence 3: Heavy Metal,2001,5.0\nThriller,The Good Mother,2013,5.0\nThriller,Last Sunset,2006,5.0\nThriller,\"Love, Cheat & Steal\",1993,5.0\n(no genres listed),Poster Girl,2010,5.0\n(no genres listed),La vida sigue igual,1969,5.0\n(no genres listed),Shark Kill,1976,5.0\n(no genres listed),Malibu Hot Summer,1981,5.0\n(no genres listed),Genius on Hold,2013,5.0\nAction,The Tattoo Connection,1978,5.0\nAction,Pony Express,1953,5.0\nAction,Hooligan,1998,5.0\nAction,Baseline,2010,5.0\nAction,I Spy Returns,1994,5.0\nAdventure,Tarzan's Savage Fury,1952,5.0\nAdventure,Temple of the White Elephant,1964,5.0\nAdventure,Future Hunters,1986,5.0\nAdventure,\"Captain Blood (Le capitan) (Invincible Swordsman, The)\",1960,5.0\nAdventure,Azit the Paratrooper Dog,1972,5.0\nChildren,Fatty Finn,1980,5.0\nChildren,Going Attractions: The Definitive Story of the American Drive-in Movie,2013,5.0\nChildren,Snow White,1987,5.0\nChildren,Lotte and the Moonstone Secret,2011,5.0\nChildren,Love Finds You In Sugarcreek,2014,5.0\nCrime,Tempo,2003,5.0\nCrime,Styx,2001,5.0\nCrime,The Capture of the Green River Killer,2008,5.0\nCrime,A Police Inspector Calls,1974,5.0\nCrime,Revenge,1978,5.0\nDocumentary,\"Hijacking Catastrophe: 9/11, Fear & the Selling of American Empire\",2004,5.0\nDocumentary,Latin Music USA,2009,5.0\nDocumentary,Junior Prom,1946,5.0\nDocumentary,Sun Kissed,2012,5.0\nDocumentary,Donos de Portugal,2012,5.0\nAnimation,Step Up Love Story (Futari ecchi),2002,4.75\nAnimation,\"Bagi, the Monster of Mighty Nature (Taishizen no makemono Bagi)\",1984,4.5\nComedy,Bed of Roses,1933,5.0\nComedy,Into the Middle of Nowhere,2010,5.0\nComedy,Inquire Within,2012,5.0\nComedy,At Ellen’s Age,2011,5.0\nComedy,Men Don't Cry,1968,5.0\nFantasy,Rocaterrania,2009,5.0\nFantasy,Aschenputtel,2010,5.0\nFantasy,The Old Fairy Tale: When the Sun Was God,2003,5.0\nFantasy,Die Gänsemagd,2009,5.0\nFantasy,Dornröschen,2009,5.0\nIMAX,Inception,2010,4.16\nDrama,A Killing in a Small Town,1990,5.0\nDrama,Geordie,1955,5.0\nDrama,Blanche Fury,1948,5.0\nDrama,Until They Sail,1957,5.0\nDrama,Invitation,1952,5.0\nFilm-Noir,Sunset Blvd. (a.k.a. Sunset Boulevard),1950,4.2\nFilm-Noir,\"Third Man, The\",1949,4.2\nFilm-Noir,Double Indemnity,1944,4.2\nFilm-Noir,Notorious,1946,4.16\nFilm-Noir,M,1931,4.16\nHorror,Siccîn,2014,5.0\nHorror,Medium Raw,2010,5.0\nHorror,\"Von einem, der auszog, das Fürchten zu lernen\",2014,5.0\nHorror,Caedes,2015,5.0\nHorror,Dark Asylum,2001,5.0\nMusical,Latin Music USA,2009,5.0\nMusical,Comin' Round the Mountain,1951,5.0\nMusical,Listen Darling,1938,4.75\nMusical,\"Chocolate Soldier, The\",1941,4.5\nMusical,\"2013 Rock and Roll Hall of Fame Induction Ceremony, The\",2013,4.5\nIMAX,\"Dark Knight Rises, The\",2012,3.98\nRomance,\"Pursuit of Unhappiness, The (Anleitung zum Unglücklichsein)\",2012,5.0\nRomance,Sins,1986,5.0\nRomance,A Matter of Time,1976,5.0\nRomance,Last Sunset,2006,5.0\nRomance,Miracle in the Rain,1956,5.0\nSci-Fi,The Hexer,2001,5.0\nSci-Fi,Say Nothing,2001,5.0\nSci-Fi,Awaken,2013,5.0\nSci-Fi,Pale,2016,5.0\nSci-Fi,Electric Nostalgia,2016,5.0\nWestern,Rio Diablo,1993,5.0\nWestern,Clearcut,1991,5.0\nWestern,Lonesome Dove Church,2014,5.0\nWestern,Pony Express,1953,5.0\nWestern,The Last Hunt,1956,5.0\nWar,Until They Sail,1957,5.0\nWar,\"In the Meantime, Darling\",1944,5.0\nWar,Keep 'Em Flying,1941,5.0\nWar,War Arrow,1954,5.0\nWar,Hitler,1962,5.0\n"}]},"apps":[],"jobName":"paragraph_1585701071403_927485444","id":"20200401-003111_350802253","dateCreated":"2020-04-01T00:31:11+0000","dateStarted":"2020-04-01T21:18:06+0000","dateFinished":"2020-04-01T21:18:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135747"},{"text":"%sh\n","user":"anonymous","dateUpdated":"2020-04-01T18:33:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585766025894_369282230","id":"20200401-183345_153640671","dateCreated":"2020-04-01T18:33:45+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:135748"}],"name":"Issoft/pyspark-topN-movies(SQL)","id":"2F774QZR6","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}